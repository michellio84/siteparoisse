<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Article</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
    /* Styles de diagnostic pour forcer chaque élément sur une ligne séparée */
    .content {
        max-width: 800px;
        margin: 2em auto;
        padding: 2em;
        background-color: #F1E7DC;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    #article-title {
        display: block;
        font-size: 2em;
        color: #614E3F;
        margin-bottom: 1em;
    }

    #article-date {
        display: block; /* Assure que la date est sur sa propre ligne */
        font-style: italic;
        color: #8B7260;
        margin-bottom: 0.5em;
    }

    #article-description {
        display: block; /* Assure que la description est sur sa propre ligne */
        font-style: italic;
        color: #8B7260;
        margin-bottom: 1em;
    }

    #article-content {
        display: block;
        margin-top: 1em;
        line-height: 1.6;
        color: #534741;
    }
</style>

</head>
<body>
    <div class="top-bar">
        <a href="/" class="church-icon"><i class="fas fa-church"></i></a>
        <nav>
            <a href="index.html">Accueil</a>
            <a href="horaires.html">Horaires</a>
            <a href="agenda.html">Agenda</a>
            <a href="actualite.html">Actualité</a>
            <a href="contact.html">Contact</a>
            <a href="histoire.html">Histoire</a>
        </nav>
    </div>

    <div class="content">
        <h1 id="article-title">Titre de l'Article</h1>
        <p id="article-date" class="date">Publié le 00/00/0000</p>
        <p id="article-description" class="description">Description de l'article</p>
        <p id="article-content" class="article-content"></p>
    </div>

    <footer>
        <a href="https://www.cathobel.be/">Cathobel.be</a>
        <a href="/politique-de-confidentialite">Politique de confidentialité</a>
        <a href="https://www.egliseinfo.be">Egliseinfo.be</a>
        <div class="contact-info">
            <p>Adresse : 3 rue Sainte-Anne, 1420 Braine-l'Alleud</p>
            <p>Téléphone : 02/384.25.12</p>
            <p>Email : <a href="mailto:secretariatstetienne@gmail.com">secretariatstetienne@gmail.com</a></p>
        </div>
    </footer>

   <script>
    const urlParams = new URLSearchParams(window.location.search);
    const slug = urlParams.get('slug');

    if (slug) {
        fetch(`/content/actualites/${slug}.md`)
            .then(response => {
                if (!response.ok) throw new Error("Erreur HTTP " + response.status);
                return response.text();
            })
            .then(markdown => {
                console.log("Contenu brut du fichier Markdown :", markdown);
                
                const metadataPattern = /---\n([\s\S]*?)\n---/;
                const metadataMatch = markdown.match(metadataPattern);
                let metadata = {};

                if (metadataMatch) {
                    const rawMetadata = metadataMatch[1];
                    rawMetadata.split('\n').forEach(line => {
                        const [key, value] = line.split(': ');
                        metadata[key.trim()] = value ? value.trim() : "";
                    });
                    markdown = markdown.replace(metadataPattern, '').trim();
                }

                console.log("Métadonnées extraites :", metadata);
                console.log("Contenu principal après extraction des métadonnées :", markdown);

                // Insertion des valeurs dans le DOM
                document.getElementById('article-title').textContent = metadata.title || "Titre manquant";
                console.log("Titre inséré :", document.getElementById('article-title').textContent);

                document.getElementById('article-date').textContent = metadata.date ? 
                    `Publié le ${new Date(metadata.date).toLocaleDateString()}` : "Date non spécifiée";
                console.log("Date insérée :", document.getElementById('article-date').textContent);

                document.getElementById('article-description').textContent = metadata.description || "";
                console.log("Description insérée :", document.getElementById('article-description').textContent);

                document.getElementById('article-content').innerHTML = markdown ? marked.parse(markdown) : "Contenu manquant.";
                console.log("Contenu principal inséré :", document.getElementById('article-content').innerHTML);
            })
            .catch(error => console.error("Erreur lors du chargement du contenu de l'article :", error));
    } else {
        document.getElementById('article-content').innerHTML = "<p>Article introuvable.</p>";
    }
</script>


</body>
</html>
