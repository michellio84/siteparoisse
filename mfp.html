<!DOCTYPE html>
<html lang="fr">
<head>
  <base href="/" />
  <meta charset="UTF-8" />
  <title>Maisons Fraternelles de la Parole</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Même base que index.html -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

  <style>
    /* ===== On ne touche pas à la barre top : styles dans styles.css ===== */

    /* Bloc(s) locaux à la page MFP uniquement */
    .content{ max-width:800px; margin:2em auto; padding:0 1em }
    h1,h2{ font-family:"Segoe UI",Arial,sans-serif }
    h1{ text-align:center }

    .section-bloc{ max-width:800px; margin:2em auto; padding:1.5em; border-radius:12px }
    .section-bloc h2{ display:flex; align-items:center; gap:.5em; margin-bottom:1em; color:#4a2f1d }
    .agenda-bloc{ background:#f3ede8 } 
    .affiche-bloc{ background:#fff } 
    .temoignage-bloc{ background:#f7f0ea }

    #agenda-mfp>div,#affiches-mfp>div,#temoignages-mfp>article{
      background:#fff; border-radius:10px; padding:1.2em; margin-bottom:1.5em;
      box-shadow:0 3px 10px rgba(0,0,0,.12);
      transition:transform .25s, box-shadow .25s, border-color .25s;
      border:1px solid rgba(0,0,0,.04)
    }
    #agenda-mfp>div:hover,#affiches-mfp>div:hover,#temoignages-mfp>article:hover{
      transform:translateY(-6px) scale(1.01);
      box-shadow:0 14px 28px rgba(0,0,0,.18);
      border-color:rgba(90,62,43,.18)
    }

    #temoignages-mfp h3{ margin:.2em 0 .3em; color:#4a2f1d }
    #temoignages-mfp .meta{ font-size:.9em; color:#777; margin-bottom:.8em }

    .tmj-body.is-collapsed{ max-height:280px; overflow:hidden; position:relative }
    .tmj-body.is-collapsed::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:3.5em;
      background:linear-gradient(to bottom, rgba(255,255,255,0), #fff)
    }
    .toggle-more{ border:0; background:transparent; color:#5a3e2b; font-weight:700; cursor:pointer; margin-top:.6em }

    img{ display:block; max-width:100%; height:auto; border-radius:8px }
    .media-spaced{ margin:1em 0 } 
    .lazy-img{ opacity:0; transform:translateY(8px); transition:opacity .4s, transform .35s }
    .lazy-img.is-loaded{ opacity:1; transform:none }

    footer{ margin-top:3em; padding:2em; background:#5a3e2b; color:#fff; text-align:center }
    footer a{ color:#ffddaa; text-decoration:none; margin:0 1em }

    /* ===== AJOUT : Logo MFP (PNG) + animations (fade-in + zoom + halo) ===== */
    .mfp-logo-wrap{ text-align:center; margin:12px 0 20px; }
    .mfp-logo{
      max-width:220px; width:60%; height:auto;
      display:inline-block; will-change:transform,opacity,filter;
    }
    .logo-fade-in{ opacity:0; transform:scale(0.94); animation:mfpFadeIn 1.2s ease-out forwards; }
    @keyframes mfpFadeIn{ to{ opacity:1; transform:none; } }
    .logo-zoom{ transition:transform .35s ease; }
    .logo-zoom:hover{ transform:scale(1.05); }
    .logo-glow{ animation:mfpGlow 2.2s ease-in-out infinite alternate; }
    @keyframes mfpGlow{
      from{ filter:drop-shadow(0 0 2px rgba(13,110,168,.35)); }
      to{   filter:drop-shadow(0 0 12px rgba(13,110,168,.55)); }
    }
    @media (prefers-reduced-motion: reduce){
      .logo-fade-in,.logo-glow{ animation:none!important }
      .logo-zoom,.mfp-logo{ transition:none!important }
    }
    /* ===== FIN AJOUT ===== */
  </style>
</head>
<body>
  <!-- Top bar : s'appuie sur styles.css (même rendu que index.html) -->
  <div class="top-bar">
    <a href="/" class="church-icon" aria-label="Accueil paroisse"><i class="fas fa-church"></i></a>
    <nav>
      <a href="index.html">Accueil</a>
      <a href="agenda.html">Agenda</a>
      <a href="actualite.html">Actualités</a>
      <a href="contact.html">Contact</a>
      <a href="histoire.html">Histoire</a>
      <a href="mfp.html" class="active">Maisons Fraternelles</a>
    </nav>
  </div>

  <div class="content">
    <h1>Maisons Fraternelles de la Parole</h1>

 <!-- Titre avec logo à gauche -->
<div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 20px;">
  <img 
    src="images/mfp-logo.png" 
    alt="Logo Maisons Fraternelles de la Parole" 
    style="height:200px; width:auto; display:block;"> 
</div>
    <p style="text-align:center">
    Les Maisons fraternelles de la Parole sont des fraternités missionnaires centrées sur la louange, dans la force de l’Esprit Saint.La Parole de Dieu y est priée, enseignée, partagée, annoncée.Elles permettent l’expérience personnelle de la rencontre avec le Seigneur et la croissance spirituelle de chacun.Elles sont ouvertes à tous et forment des disciples missionnaires dans le monde et participent à la vie de l’Eglise.Elles sont sous la vigilance de la commission épiscopale chargée du suivi du Renouveau et sont en lien avec le Service national de communion CHARIS.
    Contact : maisonfratparolebe@outlook.fr
              tel. +32 487 60 57 45 </p>
  </div>

  <section class="section-bloc agenda-bloc">
    <h2><i class="fas fa-calendar-alt"></i> Prochains événements</h2>
    <div id="agenda-mfp"></div>
  </section>

  <section class="section-bloc affiche-bloc">
    <h2><i class="fas fa-image"></i> Affiches des rencontres</h2>
    <div id="affiches-mfp"></div>
  </section>

  <section class="section-bloc temoignage-bloc">
    <h2><i class="fas fa-comment-dots"></i> Témoignages</h2>
    <div id="temoignages-mfp"></div>
  </section>

  <footer>
    <a href="https://www.cathobel.be/">Cathobel.be</a>
    <a href="/politique-de-confidentialite.html">Politique de confidentialité</a>
    <a href="https://www.egliseinfo.be">Egliseinfo.be</a>
    <div class="contact-info" style="margin-top:.8em">
      <p>Adresse : 3 rue Sainte-Anne, 1420 Braine-l'Alleud</p>
      <p>Email : <a href="mailto:secretariatstetienne@gmail.com" style="color:#ffddaa">secretariatstetienne@gmail.com</a></p>
    </div>
  </footer>

  <script src="scripts/mfp.js"></script>

  <!-- On ne touche PAS à ta logique “Lire plus / Lire moins” : rendu + lazy -->
  <script>
    function mdToHtml(md){
      if(!md) return "";
      md = md.replace(/\\\r?\n/g, "<br>");
      md = md.split(/\n{2,}/).map(p => "<p>"+p.replace(/\n/g,"<br>")+"</p>").join("");
      md = md.replace(/\*\*(.+?)\*\*/g, "<strong>$1</strong>");
      md = md.replace(/(^|[^*])\*(?!\s)(.+?)\*(?!\*)/g, "$1<em>$2</em>");
      md = md.replace(/^>\s?(.*)$/gm, "<blockquote>$1</blockquote>");
      md = md.replace(/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>');
      return md;
    }

    function renderMarkdownAndReadMore(){
      document.querySelectorAll("#temoignages-mfp article").forEach(article=>{
        let body = Array.from(article.children).find(el =>
          (el.tagName === "DIV" || el.tagName === "P") &&
          !el.classList.contains("meta") &&
          (el.textContent||"").trim().length > 0
        );
        if(!body) return;

        const raw = body.textContent.trim();
        body.innerHTML = mdToHtml(raw);
        body.classList.add("tmj-body");

        const longEnough = body.textContent.trim().length > 350 || body.querySelectorAll("p").length >= 3;
        if(longEnough){
          body.classList.add("is-collapsed");
          const btn = document.createElement("button");
          btn.className="toggle-more";
          btn.type="button";
          btn.textContent="Lire plus";
          btn.addEventListener("click", ()=>{
            const collapsed = body.classList.toggle("is-collapsed");
            btn.textContent = collapsed ? "Lire plus" : "Lire moins";
          });
          const video = article.querySelector('a[href*="http"]');
          if(video) article.insertBefore(btn, video); else article.appendChild(btn);
        }
      });

      document.querySelectorAll("#agenda-mfp img,#affiches-mfp img,#temoignages-mfp img").forEach(img=>{
        if(!img.hasAttribute("loading")) img.setAttribute("loading","lazy");
        img.classList.add("media-spaced","lazy-img");
        const onLoaded = ()=> img.classList.add("is-loaded");
        if(img.complete && img.naturalWidth>0) onLoaded(); else img.addEventListener("load", onLoaded, {once:true});
      });
    }

    window.addEventListener("load", ()=>{
      const target = document.getElementById("temoignages-mfp");
      if(!target) return;
      const once = new MutationObserver((m,obs)=>{ renderMarkdownAndReadMore(); obs.disconnect(); });
      once.observe(target, { childList:true, subtree:true });
      renderMarkdownAndReadMore();
    });
  </script>
</body>
</html>
